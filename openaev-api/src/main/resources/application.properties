# Global configuration
# suppress inspection "SpringBootApplicationProperties"
info.app.name=@project.description@
# suppress inspection "SpringBootApplicationProperties"
info.app.version=@project.version@

# OpenAEV General Configuration
openaev.name=@project.name@
openaev.version=@project.version@
openaev.base-url=http://localhost:8080
openaev.application-license=
# openaev.logout-success-url=/
# Setting up the frontend url if frontend and backend are on a different server
# openaev.frontend-url=/
openaev.cookie-name=openaev_token
openaev.cookie-secure=false
openaev.cookie-duration=P1D
openaev.unsecured-certificate=false
openaev.with-proxy=false
openaev.extra-trusted-certs-dir=
#openaev.admin.email=admin@openaev.io # mandatory
#openaev.admin.password=ChangeMe # mandatory
#openaev.admin.token=ChangeMe # mandatory
#openaev.admin.encryption_key=ChangeMe #mandatory
#openaev.admin.encryption_salt=ChangeMe #mandatory - should be at least 8 bytes long
openaev.starterpack.enabled=true

########################
# RUNTIME DEPENDENCIES #
########################
# PostgreSQL, MinIO and RabbitMQ must be configured (and running) for OpenAEV to work properly

### POSTGRESQL Configuration
### see also: https://docs.openaev.io/latest/deployment/configuration/#postgresql
# connection URL to the PostgreSQL server
# example: jdbc:postgresql://localhost:5432
spring.datasource.url=<jdbc:postgresql://...>
# Username: should be identical to the username set on the database instance
spring.datasource.username=openaev
# Password: the password for the username set above
spring.datasource.password=<password>
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_size=30
spring.datasource.hikari.maximum-pool-size=20
spring.datasource.hikari.data-source-properties.cachePrepStmts=true
spring.datasource.hikari.data-source-properties.prepStmtCacheSize=250
spring.datasource.hikari.data-source-properties.prepStmtCacheSqlLimit=2048
spring.datasource.hikari.data-source-properties.useServerPrepStmts=true

### ENGINE Configuration
# selector can be elk or opensearch
engine.engine-aws-mode=no
engine.engine-selector=elk
engine.index-prefix=openaev
engine.index-suffix=-000001
engine.url=http://localhost:9200

### MINIO Configuration
### see also: https://docs.openaev.io/latest/deployment/configuration/#s3-bucket
# hostname of the S3 bucket service
minio.endpoint=localhost
# Port of the MinIO server
minio.port=9000
# Name of the bucket; the default is fine
minio.bucket=openaev
# key and secret for accessing the bucket
minio.access-key=<key>
minio.access-secret=<secret>
# S3 configuration
openaev.s3.use-aws-role=false
openaev.s3.sts-endpoint=

### RABBITMQ settings
### see also: https://docs.openaev.io/latest/deployment/configuration/#rabbitmq
# hostname and port of the RabbitMQ server
openaev.rabbitmq.hostname=localhost
openaev.rabbitmq.port=5672
openaev.rabbitmq.prefix=openaev
openaev.rabbitmq.user=guest
openaev.rabbitmq.pass=guest
openaev.rabbitmq.vhost=/
# enable TLS for encrypted connections
openaev.rabbitmq.ssl=false
openaev.rabbitmq.management-port=15672
# RabbitMQ queue type ("classic" or "quorum")
openaev.rabbitmq.queue-type=classic
# Whether or not the calls to the management plugin of rabbitmq can be insecure
openaev.rabbitmq.management-insecure=true
# if the SSL key is set to true and Insecure Management to false,
# fill in the following settings to enable access
openaev.rabbitmq.trust-store-password=<trust-store-password>
openaev.rabbitmq.trust.store=<file:/path/to/client-store.p12>

openaev.queue-config.inject-trace.publisher-number=2
openaev.queue-config.inject-trace.consumer-number=8
openaev.queue-config.inject-trace.worker-number=8
openaev.queue-config.inject-trace.worker-frequency=10000
openaev.queue-config.inject-trace.queue-name=inject-trace
openaev.queue-config.inject-trace.max-size=200
openaev.queue-config.inject-trace.consumer-qos=1000
openaev.queue-config.inject-trace.publisher-qos=0

# Web server configuration
server.address=0.0.0.0
server.port=8080
server.servlet.context-path=/
server.servlet.session.timeout=1440m
server.ssl.enabled=false
server.http2.enabled=true
server.ssl.key-store-type=PKCS12
server.ssl.key-store=classpath:localhost.p12
server.ssl.key-store-password=admin
server.ssl.key-alias=localhost
server.compression.enabled=true

# Authenticators
## Local
openaev.auth-local-enable=true
## Oauth
openaev.auth-openid-enable=false
## Configuration examples
### Auth0
# spring.security.oauth2.client.provider.{registrationId}.issuer-uri=https://auth.auth0.io/
# spring.security.oauth2.client.registration.{registrationId}.client-name=Login with auth0
# spring.security.oauth2.client.registration.{registrationId}.client-id=
# spring.security.oauth2.client.registration.{registrationId}.client-secret=
# spring.security.oauth2.client.registration.{registrationId}.redirect-uri=${openaev.base-url}/login/oauth2/code/{registrationId}
# spring.security.oauth2.client.registration.{registrationId}.scope=openid,profile,email
### GitHub / Facebook or any other pre handled OAuth2
# spring.security.oauth2.client.registration.{registrationId}.client-name=Login with Github
# spring.security.oauth2.client.registration.{registrationId}.client-id=
# spring.security.oauth2.client.registration.{registrationId}.client-secret=

## Saml2
openaev.auth-saml2-enable=false
## Configuration examples
### Microsoft / Okta or any other saml2 providers
# spring.security.saml2.relyingparty.registration.{registrationId}.entity-id=
# spring.security.saml2.relyingparty.registration.{registrationId}.assertingparty.metadata-uri=
#### saml attibutes keys for firstname & lastname
# openaev.provider.{registrationId}.firstname_attribute_key=
# openaev.provider.{registrationId}.lastname_attribute_key=

## Oauth & Saml2
### To handle admin with sso
# openaev.provider.{registrationId}.roles_path=
# openaev.provider.{registrationId}.roles_admin=

## Kerberos
openaev.auth-kerberos-enable=false

# Technical
server.forward-headers-strategy=framework
spring.servlet.multipart.max-file-size=5GB
spring.servlet.multipart.max-request-size=5GB
spring.application.name=${openaev.name}
spring.quartz.properties.org.quartz.scheduler.instanceName=OpenAEV_Scheduler
spring.mvc.pathmatch.matching-strategy=ant_path_matcher
spring.quartz.properties.org.quartz.threadPool.threadCount=10
spring.data.rest.basePath=/api
springdoc.api-docs.path=/api-docs
springdoc.swagger-ui.validatorUrl=none

# Encoding
spring.mail.default-encoding=UTF-8
spring.messages.encoding=UTF-8
server.tomcat.uri-encoding=UTF-8
spring.freemarker.charset=UTF-8
server.servlet.encoding.charset=UTF-8

# ORM
spring.jpa.hibernate.ddl-auto=none
# spring.jpa.show-sql=true
# spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.batch_size=50
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Database schema migrations
spring.flyway.url=${spring.datasource.url}
spring.flyway.user=${spring.datasource.username}
spring.flyway.password=${spring.datasource.password}
spring.flyway.table=migrations
spring.flyway.locations=classpath:io/openaev/migration
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.postgresql.transactional-lock=false

# AI Properties
ai.enabled=false
ai.type=mistralai
ai.endpoint=
ai.token=
ai.model=mistral
ai.model_images=

# Inject execution threshold, by default it's 10minutes
inject.execution.threshold.minutes=

# Logging
logging.level.root=fatal
logging.level.org.flywaydb=error
logging.level.io.openaev=error
logging.level.com.zaxxer.hikari=warn
logging.file.name=./logs/openaev.log
logging.logback.rollingpolicy.file-name-pattern=${LOG_FILE}.-%d{yyyy-MM-dd}.%i
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=7

#############
# EXECUTORS #
#############

# Executor Caldera
executor.caldera.enable=false
executor.caldera.id=2f9a0936-c327-4e95-b406-d161d32a2500
executor.caldera.url=<caldera-url>
executor.caldera.public-url=<caldera-public-url>
executor.caldera.api-key=<caldera-api-key>

# Executor Tanium
executor.tanium.enable=false
executor.tanium.id=fbcce3cc-9cd3-4fdb-b451-1c90f4ae035d
executor.tanium.url=<tanium-url>
executor.tanium.api-batch-execution-action-pagination=100
executor.tanium.api-register-interval=1200
executor.tanium.clean-implant-interval=8
executor.tanium.api-key=<tanium-api-key>
executor.tanium.computer-group-id=1
executor.tanium.action-group-id=4
executor.tanium.windows-package-id=
executor.tanium.unix-package-id=

# Executor CrowdStrike
executor.crowdstrike.enable=false
executor.crowdstrike.id=2a16dcc4-55ac-40fc-8110-d5968a46cdd1
executor.crowdstrike.api-url=https://api.us-2.crowdstrike.com
executor.crowdstrike.api-batch-execution-action-pagination=2500
executor.crowdstrike.api-register-interval=1200
executor.crowdstrike.clean-implant-interval=8
executor.crowdstrike.client-id=<crowdstrike-client-id>
executor.crowdstrike.client-secret=<crowdstrike-client-secret>
executor.crowdstrike.host-group=<host-group>
executor.crowdstrike.windows-script-name=OpenAEV Subprocessor (Windows)
executor.crowdstrike.unix-script-name=OpenAEV Subprocessor (Unix)

# Executor SentinelOne
executor.sentinelone.enable=false
executor.sentinelone.id=9a12c0dd-1f6d-4ed4-a773-8034934fc111
executor.sentinelone.url=<sentinelone-url>
executor.sentinelone.api-key=<sentinelone-api-key>
executor.sentinelone.api-batch-execution-action-pagination=2500
executor.sentinelone.api-register-interval=1200
executor.sentinelone.clean-implant-interval=8
executor.sentinelone.account-id=
executor.sentinelone.site-id=
executor.sentinelone.group-id=
executor.sentinelone.windows-script-id=
executor.sentinelone.unix-script-id=

# Executor OpenAEV

# valid values: local | repository
# default: local
executor.openaev.binaries.origin=local

# if executor.openaev.agent.binaries.origin is set to "local",
# this config is ignored
# default: the OpenAEV instance's version
executor.openaev.binaries.version=@project.version@

#############
# INJECTORS #
#############

### /!\ MAKE SURE TO SET UP RABBITMQ (see RabbitMQ section above)

# Mail sending config (Always available, mandatory)
openaev.default-mailer=no-reply@openaev.io
openaev.default-reply-to=contact@openaev.io
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=<username@mail.com>
spring.mail.password=<password>
# Extra mail configuration
spring.mail.properties.mail.smtp.ssl.trust=*
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.ssl.enable=false
spring.mail.properties.mail.smtp.starttls.enable=true
# IMAP Configuration
openaev.mail.imap.enabled=false
openaev.mail.imap.host=imap.mail.com
openaev.mail.imap.username=<username@mail.com>
openaev.mail.imap.password=<password>
openaev.mail.imap.port=993
openaev.mail.imap.inbox=INBOX
openaev.mail.imap.sent=Sent
# Extra IMAP configuration
openaev.mail.imap.ssl.trust=*
openaev.mail.imap.ssl.enable=true
openaev.mail.imap.auth=true
openaev.mail.imap.starttls.enable=false
# Extra XTM configuration
openaev.xtm.opencti.enable=false
openaev.xtm.opencti.url=<opencti-url>
#openaev.xtm.opencti.api_url=<opencti-api-url>
openaev.xtm.opencti.token=<opencti-token>
openaev.xtm.hub.enable=true
openaev.xtm.hub.url=https://hub.filigran.io
openaev.xtm.hub.connectivity-email-enable=true

#openaev.xtm.hub.override-api-url=<override-hub-api-url>
openaev.xtm.hub.collector.enable=false
openaev.xtm.hub.collector.id=b402f1f5-29ba-4ee3-b366-f0467754cf4e
#openaev.xtm.hub.collector.connectivity-check-interval=3600000

# security coverage connector
#openaev.xtm.opencti.connector.security-coverage.url=
#openaev.xtm.opencti.connector.security-coverage.id=
#openaev.xtm.opencti.connector.security-coverage.auth-token=

# XLS Import
openaev.xls.import.mail.enable=true
openaev.xls.import.sms.enable=true

# Injector Caldera config
injector.caldera.enable=false
injector.caldera.id=7736918d-6a3f-46c7-b303-cbf5dc476c84
injector.caldera.url=<caldera-url>
injector.caldera.public-url=<caldera-public-url>
injector.caldera.api-key=<caldera-api-key>

# OVH SMS config
ovh.sms.enable=false
ovh.sms.ak=<ak>
ovh.sms.as=<as>
ovh.sms.ck=<ck>
ovh.sms.service=<service>
ovh.sms.sender=<sender>

# Mastodon config
mastodon.enable=false
mastodon.url=<url>

# Airbus LADE config
lade.enable=false
lade.url=<url>
lade.session=30
lade.username=<username>
lade.password=<password>

### Expectation

openaev.expectation.technical.expiration-time=21600
#openaev.expectation.detection.expiration-time=21600
#openaev.expectation.prevention.expiration-time=21600

openaev.expectation.human.expiration-time=86400
#openaev.expectation.challenge.expiration-time=3600
#openaev.expectation.article.expiration-time=3600
#openaev.expectation.manual.expiration-time=3600

# Min value: 1
# Max value: 100
# Default value: 50
openaev.expectation.manual.default-score-value=50


#Health check
# a unique random string used when calling the health endpoint
# Example of a call : /api/health?health_access_key=ChangeMe
openaev.healthcheck.key=ChangeMe

# Pyroscope properties
pyroscope.agent.enabled=false
pyroscope.agent.instance=OpenAEV
pyroscope.profiler.event=itimer
pyroscope.profiler.alloc=512k
pyroscope.profiler.lock=10ms
pyroscope.server.address=<pyroscope.url>

## remediation detection AI Webservice
#remediation.detection.webservice=
#remediation.detection.webservice.retry=
#remediation.detection.webservice.retry.waiting.milliseconds=


# Enable actuator -> disabled by default
management.endpoints.web.exposure.include=
#management.endpoints.web.exposure.include=metrics,prometheus
management.endpoint.health.show-details=always
management.server.port=8080