package io.openaev.model.expectation;

import static io.openaev.database.model.InjectExpectation.EXPECTATION_TYPE.VULNERABILITY;

import io.openaev.database.model.*;
import io.openaev.model.Expectation;
import java.util.List;
import lombok.Data;

/**
 * Expectation that verifies vulnerability assessment results.
 *
 * <p>Vulnerability expectations are used to track and verify the identification of security
 * vulnerabilities in target systems. This is commonly used in scenarios where:
 *
 * <ul>
 *   <li>Vulnerability scanning is being tested
 *   <li>Patch management effectiveness is being measured
 *   <li>Security assessment coverage is being validated
 * </ul>
 *
 * <p>Vulnerability expectations can target agents, assets, or asset groups, similar to detection
 * and prevention expectations.
 *
 * @see Expectation
 * @see InjectExpectationSignature
 * @see DetectionExpectation
 */
@Data
public class VulnerabilityExpectation implements Expectation {

  /** The score value when this expectation is fulfilled (0-100). */
  private Double score;

  /** Display name for this expectation. */
  private String name;

  /** Detailed description of the vulnerability to identify. */
  private String description;

  /** The specific agent associated with this expectation. */
  private Agent agent;

  /** The asset where vulnerability should be found. */
  private Asset asset;

  /** The asset group being evaluated. */
  private AssetGroup assetGroup;

  /** Whether this expectation is part of a group evaluation. */
  private boolean expectationGroup;

  /** Time in seconds after which this expectation expires. */
  private Long expirationTime;

  /** Signatures that can satisfy this vulnerability expectation. */
  private List<InjectExpectationSignature> injectExpectationSignatures;

  /** Creates an empty vulnerability expectation. */
  public VulnerabilityExpectation() {}

  @Override
  public InjectExpectation.EXPECTATION_TYPE type() {
    return VULNERABILITY;
  }
}
